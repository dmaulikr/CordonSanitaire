<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Cordon Sanitaire | Pre-Alpha</title>
	<meta name="description" content="Cordon Sanitaire. Contain the outbreak.">
	<meta name="author" content="Jonathan Bobrow  @jonathanbobrow">
	<link rel="stylesheet" href="css/style.css">

	<!-- dependencies -->
	<script type="text/javascript" src="http://cdn.pubnub.com/pubnub-3.7.1.min.js"></script>
	<script type="text/javascript" src="http://www.parsecdn.com/js/parse-1.3.1.min.js"></script>

	<!-- my code -->
	<script type="text/javascript" src="js/timer.js"></script>
	<script type="text/javascript" src="js/app.js"></script>
	<script type="text/javascript" src="js/paper-core.min.js"></script>
	<script type="text/javascript" src="js/paper-full.min.js"></script>
	<script type="text/paperscript" canvas="sample">

	var people = [];

	function Person(x, y) {
		this.x = x;
		this.y = y;
		this.loc = new Point(x,y);
		//this.state = state;
	}

	Person.prototype = {
		update: function() {

		},

		updateShape: function() {

		},

		isInside: function() {
			return true;
		}

	};

	//load people
	loadPeople();

    function loadPeople() {
    	var users = Parse.Object.extend("SimpleUser");
		var query = new Parse.Query(users);
		query.equalTo("present", true);
		query.find({
		  	success: function(results) {
			    // list contains the present players.
			    	console.log(results);
			    	console.log("# of present: " + results.length);
			    // draw this list of players across the screen.
			    for (var i = 0; i < results.length; i++) { 
			    	var object = results[i];
			    	//console.log('paper - ' + object.get('playerID') + ' - ' + object.get('active'));

			    	people.push(new Person(object.get('x'), object.get('y')));
			    }

			    sortPeople();
			    createQuarantine();
		  	},
			error: function(object, error) {
			    // The object was not retrieved successfully.
			    // error is a Parse.Error with an error code and message.
			    console.log("Error: " + error.code + " " + error.message);
			}
		});
    }

    // sort people
    function sortPeople() {
    	
    }

   	// draw people
    function createQuarantine() {
 		var center = view.size * .5;
        var path = new Path();
        path.closed = true;
        
        console.log("# of people: " + people.length);

        for (var i = 0; i<people.length; i++) {
        	path.add(view.size * people[i].loc);
            var shape = new Shape.Circle(view.size * people[i].loc, 10);
            shape.strokeWidth=5;
            shape.strokeColor = 'black';
            shape.fillColor = 'yellow';
        }

        // path.smooth();
        path.fillColor = 'white';
        path.strokeWidth = 10;
        path.strokeColor = 'black';
        path.strokeJoin = 'round';
    }

    
    // update loop
    function onFrame() {
    	// do stuff on each frame here
    }

    //var hitResult = project.hitTest(event.point, hitOptions);
    </script>
</head>

<body>
	<header>
		<div>
			<h1>Cordon Sanitaire</h1>
			<h2>Work together to contain the outbreak.</h2>
		</div>
	</header>

	<div id="sign_in">
	</div>
	
	<input type="button" name="start" onclick="startTheClock()"><label>start</label>

	<div id="countdown">
	</div>
	
	<div id="draw">
		<canvas id="sample" resize></canvas>
	</div>

	<!--
	<div id="map">
		<img id="map_image" src="img/manhattan.jpg"/>
		<canvas id="drawCanvas" width="300" height="300">Canvas is not supported on this browser!</canvas>
	</div>
	-->

	<div class="toggle-btn-grp">
		<div id="button_1"><input type="radio" name="status" id="inactive" onclick="setUserActiveState(false)" checked><label class="toggle-btn">inactive</label></div> 
		<div id="button_2"><input type="radio" name="status" id="active" onclick="setUserActiveState(true)"><label class="toggle-btn">active</label></div>  
	</div>

	<div id="side_panel">
	</div>

	<footer>
	</footer>	
</body>
</html>